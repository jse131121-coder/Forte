<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>FORTE</title>

<style>
:root{
  --bg:#000; --card:#111; --text:#fff; --sub:#aaa; --line:#222;
}
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,sans-serif;}
body{
  margin:0; background:var(--bg); color:var(--text);
  display:flex; justify-content:center;
}
.app{
  width:100%; max-width:420px; min-height:100vh;
  border-left:1px solid var(--line);
  border-right:1px solid var(--line);
}
header{
  padding:16px; text-align:center;
  border-bottom:1px solid var(--line);
  letter-spacing:2px; font-weight:600;
}
section{display:none;padding:16px;padding-bottom:90px;}
section.active{display:block;}
nav{
  position:fixed; bottom:0; width:100%; max-width:420px;
  display:flex; border-top:1px solid var(--line); background:#000;
}
nav button{
  flex:1; padding:14px 0; background:none; border:none;
  color:var(--sub); font-size:12px;
}
nav button.active{color:var(--text);}
.card{
  background:var(--card); border:1px solid var(--line);
  border-radius:12px; padding:14px; margin-bottom:12px;
}
.badge{
  font-size:10px; border:1px solid #fff;
  padding:2px 6px; border-radius:999px; margin-left:6px;
}
input,textarea{
  width:100%; background:#000; color:#fff;
  border:1px solid var(--line); border-radius:8px;
  padding:10px; margin-bottom:8px;
}
button.primary{
  width:100%; background:#fff; color:#000;
  border:none; border-radius:8px;
  padding:12px; font-weight:600;
}
.comment{
  border-top:1px solid var(--line);
  padding-top:6px; margin-top:6px; font-size:14px;
}
.chat-box{display:flex;flex-direction:column;gap:6px;}
.msg{
  max-width:70%; padding:8px 12px;
  border-radius:12px; font-size:14px;
}
.fan{background:#111;align-self:flex-start;}
.artist{background:#fff;color:#000;align-self:flex-end;}
.center{color:var(--sub);text-align:center;margin-top:40px;}
.danger{
  background:none; color:#fff; border:1px solid #fff;
  padding:10px; border-radius:8px;
}
</style>
</head>

<body>
<div class="app">
<header>FORTE</header>

<!-- HOME -->
<section id="home" class="active">
  <div class="center">
    Forte Official Fan Space<br/><br/>
    MUSE · BLACK & WHITE
  </div>
  <div id="resetArea"></div>
</section>

<!-- COMMUNITY -->
<section id="community">
  <div class="card">
    <textarea id="postText" placeholder="Write something..."></textarea>
    <button class="primary" onclick="addPost()">POST</button>
  </div>
  <div id="posts"></div>
</section>

<!-- CHAT LIST -->
<section id="chatlist">
  <div class="card" onclick="openChat()">Forte (Artist)</div>
</section>

<!-- CHAT -->
<section id="chat">
  <div class="chat-box" id="chatBox"></div>
  <input id="chatInput" placeholder="Message..." />
  <button class="primary" onclick="sendChat()">SEND</button>
</section>

<nav>
  <button class="active" onclick="go('home',this)">HOME</button>
  <button onclick="go('community',this)">COMMUNITY</button>
  <button onclick="go('chatlist',this)">CHAT</button>
</nav>
</div>

<script>
/* ROLE */
let role = localStorage.getItem("role");
if(!role){
  role = confirm("Artist(Forte)로 접속할까요?") ? "artist" : "fan";
  localStorage.setItem("role",role);
}

/* RESET (Artist only) */
if(role==="artist"){
  document.getElementById("resetArea").innerHTML = `
    <button class="danger" onclick="resetSite()">⚠ 사이트 내용 초기화</button>
  `;
}
function resetSite(){
  if(!confirm("모든 글·댓글·채팅이 삭제됩니다. 계속할까요?")) return;
  localStorage.removeItem("posts");
  localStorage.removeItem("chats");
  location.reload();
}

/* POSTS */
let posts = JSON.parse(localStorage.getItem("posts")||"[]");

function addPost(){
  const text = postText.value.trim();
  if(!text) return;
  posts.unshift({text,role,comments:[]});
  savePosts(); postText.value="";
}
function addComment(i,val){
  if(!val) return;
  posts[i].comments.push(val);
  savePosts();
}
function savePosts(){
  localStorage.setItem("posts",JSON.stringify(posts));
  renderPosts();
}
function renderPosts(){
  const el=document.getElementById("posts");
  el.innerHTML="";
  posts.forEach((p,i)=>{
    el.innerHTML+=`
      <div class="card">
        <b>${p.role==="artist"?"Forte":"Fan"}
        ${p.role==="artist"?'<span class="badge">Artist</span>':""}</b>
        <p>${p.text}</p>
        <input placeholder="Comment..."
        onkeydown="if(event.key==='Enter')addComment(${i},this.value)">
        ${p.comments.map(c=>`<div class="comment">${c}</div>`).join("")}
      </div>`;
  });
}

/* CHAT */
let chats = JSON.parse(localStorage.getItem("chats")||"[]");
function openChat(){go("chat");renderChat();}
function sendChat(){
  const t=chatInput.value.trim(); if(!t) return;
  chats.push({text:t,role});
  localStorage.setItem("chats",JSON.stringify(chats));
  chatInput.value=""; renderChat();
}
function renderChat(){
  const box=document.getElementById("chatBox");
  box.innerHTML="";
  chats.forEach(m=>{
    box.innerHTML+=`<div class="msg ${m.role}">${m.text}</div>`;
  });
}

/* NAV */
function go(id,btn){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  if(btn) btn.classList.add("active");
}

renderPosts(); renderChat();
</script>
</body>
</html>

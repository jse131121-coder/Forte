<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FORTE</title>

<style>
*{box-sizing:border-box;font-family:Arial}
body{margin:0;background:#000;color:#fff}
.hidden{display:none}
.center{
  height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center
}
input,textarea,button{
  width:80%;
  max-width:400px;
  background:#000;
  color:#fff;
  border:1px solid #fff;
  padding:10px;
  margin:5px 0
}
nav{
  display:flex;
  justify-content:space-around;
  border-bottom:1px solid #fff
}
.page{padding:10px}
.post,.chat{border-bottom:1px solid #333;padding:8px}
.chat.forte{text-align:left}
.chat.artist{text-align:right}
.date{
  text-align:center;
  font-size:12px;
  opacity:.5;
  margin:10px 0
}
</style>
</head>

<body>

<div id="loginScreen" class="center">
  <h1>FORTE</h1>
  <input id="login_id" placeholder="ID">
  <input id="login_pw" type="password" placeholder="Password">
  <button id="login_btn">LOGIN</button>
</div>

<div id="appScreen" class="hidden">

<nav>
  <button data-page="home">HOME</button>
  <button data-page="community">COMMUNITY</button>
  <button data-page="chat">CHAT</button>
</nav>

<section id="home" class="page">Welcome.</section>

<section id="community" class="page hidden">
  <textarea id="post_input" placeholder="Write..."></textarea>
  <button id="post_btn">POST</button>
  <div id="post_list"></div>
</section>

<section id="chat" class="page hidden">
  <div id="chat_box"></div>
  <textarea id="chat_input" placeholder="Message..."></textarea>
  <button id="chat_btn">SEND</button>
</section>

</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  let currentUser = null;

  const posts = JSON.parse(localStorage.getItem("posts") || "[]");
  const chats = JSON.parse(localStorage.getItem("chats") || "[]");

  const loginScreen = document.getElementById("loginScreen");
  const appScreen = document.getElementById("appScreen");

  document.getElementById("login_btn").onclick = () => {
    const id = document.getElementById("login_id").value;
    const pw = document.getElementById("login_pw").value;

    if(id === "Artist" && pw === "Artist") currentUser = "Artist";
    else if(id === "Forte" && pw === "01024773752") currentUser = "Forte";
    else return alert("ë¡œê·¸ì¸ ì‹¤íŒ¨");

    loginScreen.classList.add("hidden");
    appScreen.classList.remove("hidden");
    renderPosts();
    renderChats();
  };

  document.querySelectorAll("nav button").forEach(btn=>{
    btn.onclick = () => {
      document.querySelectorAll(".page").forEach(p=>p.classList.add("hidden"));
      document.getElementById(btn.dataset.page).classList.remove("hidden");
    };
  });

  /* ì»¤ë®¤ë‹ˆí‹° */
  document.getElementById("post_btn").onclick = () => {
    const input = document.getElementById("post_input");
    if(!input.value.trim()) return;

    posts.push({ text: input.value, time: Date.now() });
    localStorage.setItem("posts", JSON.stringify(posts));
    input.value="";
    renderPosts();
  };

  function renderPosts(){
    const list = document.getElementById("post_list");
    list.innerHTML="";
    posts.forEach((p,i)=>{
      const div=document.createElement("div");
      div.className="post";
      div.innerHTML = `
        <pre>${p.text}</pre>
        ${currentUser==="Forte"
          ? `<button onclick="deletePost(${i})">ì‚­ì œ</button>`
          : ""}
      `;
      list.appendChild(div);
    });
  }

  window.deletePost = (i)=>{
    posts.splice(i,1);
    localStorage.setItem("posts", JSON.stringify(posts));
    renderPosts();
  };

  /* ì±„íŒ… */
  document.getElementById("chat_btn").onclick = () => {
    const input=document.getElementById("chat_input");
    if(!input.value.trim()) return;

    chats.push({
      text: input.value,
      user: currentUser,
      time: new Date().toDateString()
    });
    localStorage.setItem("chats", JSON.stringify(chats));
    input.value="";
    renderChats();
  };

  function renderChats(){
    const box=document.getElementById("chat_box");
    box.innerHTML="";
    let lastDate="";

    chats.forEach((c,i)=>{
      if(c.time !== lastDate){
        const d=document.createElement("div");
        d.className="date";
        d.innerText=c.time;
        box.appendChild(d);
        lastDate=c.time;
      }

      const div=document.createElement("div");
      div.className=`chat ${c.user==="Forte"?"forte":"artist"}`;
      div.innerHTML = `
        ${c.user==="Forte" ? "Forte ðŸ–¤<br>" : ""}
        <pre>${c.text}</pre>
        ${currentUser==="Forte"
          ? `<button onclick="deleteChat(${i})">ì‚­ì œ</button>`
          : ""}
      `;
      box.appendChild(div);
    });
  }

  window.deleteChat = (i)=>{
    chats.splice(i,1);
    localStorage.setItem("chats", JSON.stringify(chats));
    renderChats();
  };

});
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FORTE</title>

<style>
:root{
  --bg:#000; --card:#111; --line:#222; --text:#fff; --sub:#aaa;
}
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,sans-serif;}
body{margin:0;background:var(--bg);color:var(--text);display:flex;justify-content:center;}
.app{width:100%;max-width:420px;min-height:100vh;border-left:1px solid var(--line);border-right:1px solid var(--line);}
header{padding:14px;text-align:center;border-bottom:1px solid var(--line);letter-spacing:2px;}
section{display:none;padding:14px;padding-bottom:90px;}
section.active{display:block;}
nav{position:fixed;bottom:0;width:100%;max-width:420px;display:flex;border-top:1px solid var(--line);background:#000;}
nav button{flex:1;background:none;border:none;color:var(--sub);padding:12px;font-size:12px;}
nav button.active{color:#fff;}
.card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:12px;margin-bottom:12px;}
textarea,input{width:100%;background:#000;color:#fff;border:1px solid var(--line);border-radius:8px;padding:8px;}
button.primary{width:100%;background:#fff;color:#000;border:none;border-radius:8px;padding:10px;margin-top:6px;font-weight:600;}
.small{font-size:12px;color:var(--sub);}
.danger{background:none;border:1px solid #fff;color:#fff;padding:4px 8px;border-radius:6px;font-size:11px;margin-right:4px;}
.msg{max-width:70%;padding:8px 12px;border-radius:14px;font-size:14px;white-space:pre-wrap;}
.fan{background:#111;align-self:flex-end;}
.artist{background:#fff;color:#000;align-self:flex-start;}
.chat-box{display:flex;flex-direction:column;gap:6px;}
.date{color:var(--sub);text-align:center;font-size:12px;margin:10px 0;}
.profile{font-size:12px;margin-bottom:2px;display:flex;align-items:center;gap:6px;}
.avatar{width:20px;height:20px;border-radius:50%;background:#000;border:1px solid #000;color:#000;display:flex;align-items:center;justify-content:center;font-size:12px;}
</style>
</head>

<body>
<div class="app">
<header>FORTE</header>

<section id="home" class="active">
  <div class="card small">Official Fan Space</div>
  <div id="adminSettings"></div>
</section>

<section id="community">
  <div class="card">
    <textarea id="postInput" rows="3" placeholder="Write something..."></textarea>
    <button class="primary" onclick="addPost()">POST</button>
  </div>
  <div id="postList"></div>
</section>

<section id="chatlist">
  <div class="card" onclick="go('chat')">Forte</div>
</section>

<section id="chat">
  <div class="chat-box" id="chatBox"></div>
  <textarea id="chatInput" rows="2" placeholder="Message..."></textarea>
  <button class="primary" onclick="sendChat()">SEND</button>
</section>

<nav>
  <button class="active" onclick="go('home',this)">HOME</button>
  <button onclick="go('community',this)">COMMUNITY</button>
  <button onclick="go('chatlist',this)">CHAT</button>
</nav>
</div>

<script>
/* LOGIN */
let role=null;
while(!role){
  const id=prompt("ID");
  const pw=prompt("PASSWORD");
  if(id==="Forte" && pw==="01024773752") role="admin";
  else if(id==="Artist" && pw==="Artist") role="fan";
}

/* ADMIN PROFILE */
let artistName=localStorage.getItem("artistName")||"Forte";
let artistAvatar=localStorage.getItem("artistAvatar")||"●";

if(role==="admin"){
  adminSettings.innerHTML=`
  <div class="card">
    <b>Admin Settings</b><br><br>
    <input value="${artistName}" onchange="setName(this.value)">
    <input value="${artistAvatar}" onchange="setAvatar(this.value)">
  </div>`;
}
function setName(v){artistName=v;localStorage.setItem("artistName",v);renderChat();}
function setAvatar(v){artistAvatar=v;localStorage.setItem("artistAvatar",v);renderChat();}

/* COMMUNITY */
let posts=JSON.parse(localStorage.getItem("posts")||"[]");

function addPost(){
  const t=postInput.value.trim();
  if(!t)return;
  posts.unshift({text:t,editing:false,comments:[]});
  postInput.value="";
  savePosts();
}

function renderPosts(){
  postList.innerHTML="";
  posts.forEach((p,i)=>{
    postList.innerHTML+=`
    <div class="card">
      ${p.editing?`
        <textarea onchange="editPost(${i},this.value)">${p.text}</textarea>
        <button class="danger" onclick="toggleEdit(${i})">DONE</button>
      `:`<pre>${p.text}</pre>`}
      ${role==="admin" && !p.editing?`
        <button class="danger" onclick="toggleEdit(${i})">EDIT</button>
        <button class="danger" onclick="deletePost(${i})">DEL</button>`:""}
      <textarea placeholder="comment..." onkeydown="if(event.key==='Enter')addComment(${i},this.value)"></textarea>
      ${p.comments.map((c,ci)=>`
        <div class="small">
          ${c.editing?`
            <input value="${c.text}" onchange="editComment(${i},${ci},this.value)">
            <button class="danger" onclick="toggleComment(${i},${ci})">OK</button>
          `:c.text}
          ${role==="admin" && !c.editing?`
            <button class="danger" onclick="toggleComment(${i},${ci})">E</button>
            <button class="danger" onclick="deleteComment(${i},${ci})">X</button>`:""}
        </div>`).join("")}
    </div>`;
  });
}

function toggleEdit(i){posts[i].editing=!posts[i].editing;savePosts();}
function editPost(i,v){posts[i].text=v;}
function deletePost(i){posts.splice(i,1);savePosts();}

function addComment(i,t){
  if(!t)return;
  posts[i].comments.push({text:t,editing:false});
  savePosts();
}
function toggleComment(i,ci){posts[i].comments[ci].editing=!posts[i].comments[ci].editing;savePosts();}
function editComment(i,ci,v){posts[i].comments[ci].text=v;}
function deleteComment(i,ci){posts[i].comments.splice(ci,1);savePosts();}
function savePosts(){localStorage.setItem("posts",JSON.stringify(posts));renderPosts();}

/* CHAT */
let chats=JSON.parse(localStorage.getItem("chats")||"[]");

function sendChat(){
  const t=chatInput.value.trim();
  if(!t)return;
  chats.push({
    text:t, editing:false,
    role:role,
    date:new Date().toLocaleDateString()
  });
  chatInput.value="";
  saveChat();
}

function renderChat(){
  chatBox.innerHTML="";
  let last="";
  chats.forEach((m,i)=>{
    if(m.date!==last){
      chatBox.innerHTML+=`<div class="date">── ${m.date} ──</div>`;
      last=m.date;
    }
    chatBox.innerHTML+=`
    <div class="msg ${m.role==="admin"?"artist":"fan"}">
      ${m.role==="admin"?`
        <div class="profile">
          <div class="avatar">${artistAvatar}</div>${artistName}
        </div>`:""}
      ${m.editing?`
        <textarea onchange="editChat(${i},this.value)">${m.text}</textarea>
        <button class="danger" onclick="toggleChat(${i})">OK</button>
      `:m.text}
      ${role==="admin" && !m.editing?`
        <button class="danger" onclick="toggleChat(${i})">EDIT</button>
        <button class="danger" onclick="deleteChat(${i})">DEL</button>`:""}
    </div>`;
  });
}

function toggleChat(i){chats[i].editing=!chats[i].editing;saveChat();}
function editChat(i,v){chats[i].text=v;}
function deleteChat(i){chats.splice(i,1);saveChat();}
function saveChat(){localStorage.setItem("chats",JSON.stringify(chats));renderChat();}

/* NAV */
function go(id,btn){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  if(btn)btn.classList.add("active");
}

renderPosts();renderChat();
</script>
</body>
</html>



<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A</title>

<style>
*{box-sizing:border-box;font-family:Arial}
body{margin:0;background:#000;color:#fff}
.hidden{display:none}
.center{
  height:100vh;display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center
}
input,textarea,button{
  width:80%;max-width:400px;
  background:#000;color:#fff;
  border:1px solid #fff;
  padding:10px;margin:5px 0
}
nav{
  display:flex;
  justify-content:space-around;
  border-bottom:1px solid #fff
}
.page{padding:10px}
.post,.chat{border-bottom:1px solid #333;padding:8px}
.chat.forte{text-align:left}
.chat.artist{text-align:right}
.date{
  text-align:center;
  font-size:12px;
  opacity:.5;
  margin:10px 0
}
</style>
</head>

<body>

<!-- ë¡œê·¸ì¸ -->
<div id="loginScreen" class="center">
  <h1>A</h1>
  <input id="loginId" placeholder="ID">
  <input id="loginPw" type="password" placeholder="Password">
  <button onclick="doLogin()">LOGIN</button>
</div>

<!-- ì•± -->
<div id="app" class="hidden">

<nav>
  <button onclick="showPage('home')">HOME</button>
  <button onclick="showPage('community')">COMMUNITY</button>
  <button onclick="showPage('chat')">CHAT</button>
</nav>

<section id="home" class="page">Welcome.</section>

<section id="community" class="page hidden">
  <textarea id="postInput" placeholder="Write..."></textarea>
  <button onclick="addPost()">POST</button>
  <div id="postList"></div>
</section>

<section id="chat" class="page hidden">
  <div id="chatBox"></div>
  <textarea id="chatInput" placeholder="Message..."></textarea>
  <button onclick="sendChat()">SEND</button>
</section>

</div>

<script>
let currentUser = null;

const posts = JSON.parse(localStorage.getItem("posts") || "[]");
const chats = JSON.parse(localStorage.getItem("chats") || "[]");

/* ë¡œê·¸ì¸ */
function doLogin(){
  const id = document.getElementById("loginId").value;
  const pw = document.getElementById("loginPw").value;

  if(id==="Artist" && pw==="Artist") currentUser="Artist";
  else if(id==="Forte" && pw==="01024773752") currentUser="Forte";
  else return alert("ë¡œê·¸ì¸ ì‹¤íŒ¨");

  document.getElementById("loginScreen").classList.add("hidden");
  document.getElementById("app").classList.remove("hidden");
  renderPosts();
  renderChats();
}

/* íŽ˜ì´ì§€ ì „í™˜ */
function showPage(page){
  document.querySelectorAll(".page").forEach(p=>p.classList.add("hidden"));
  document.getElementById(page).classList.remove("hidden");
}

/* ì»¤ë®¤ë‹ˆí‹° */
function addPost(){
  const input = document.getElementById("postInput");
  if(!input.value.trim()) return;

  const post = { text: input.value, time: Date.now() };
  posts.push(post);
  localStorage.setItem("posts", JSON.stringify(posts));
  renderPosts();
  input.value="";
}

function renderPosts(){
  const list = document.getElementById("postList");
  list.innerHTML="";
  posts.forEach((p,i)=>{
    const div=document.createElement("div");
    div.className="post";
    div.innerHTML=`
      <pre>${p.text}</pre>
      ${currentUser==="Forte"
        ? `<button onclick="deletePost(${i})">ì‚­ì œ</button>`
        : ""}
    `;
    list.appendChild(div);
  });
}

function deletePost(i){
  posts.splice(i,1);
  localStorage.setItem("posts", JSON.stringify(posts));
  renderPosts();
}

/* ì±„íŒ… */
let lastDate="";

function sendChat(){
  const input=document.getElementById("chatInput");
  if(!input.value.trim()) return;

  const chat={
    text:input.value,
    user:currentUser,
    time:new Date()
  };
  chats.push(chat);
  localStorage.setItem("chats", JSON.stringify(chats));
  renderChats();
  input.value="";
}

function renderChats(){
  const box=document.getElementById("chatBox");
  box.innerHTML="";
  lastDate="";

  chats.forEach((c,i)=>{
    const d=c.time.toDateString();
    if(d!==lastDate){
      const dateDiv=document.createElement("div");
      dateDiv.className="date";
      dateDiv.innerText=d;
      box.appendChild(dateDiv);
      lastDate=d;
    }

    const div=document.createElement("div");
    div.className=`chat ${c.user==="Forte"?"forte":"artist"}`;
    div.innerHTML=`
      ${c.user==="Forte"?"Forte ðŸ–¤<br>":""}
      <pre>${c.text}</pre>
      ${currentUser==="Forte"
        ? `<button onclick="deleteChat(${i})">ì‚­ì œ</button>`
        : ""}
    `;
    box.appendChild(div);
  });
}

function deleteChat(i){
  chats.splice(i,1);
  localStorage.setItem("chats", JSON.stringify(chats));
  renderChats();
}
</script>

</body>
</html>
